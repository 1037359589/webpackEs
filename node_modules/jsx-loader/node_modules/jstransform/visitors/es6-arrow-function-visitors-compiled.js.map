{"version":3,"sources":["es6-arrow-function-visitors.js"],"names":[],"mappings":"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","file":"es6-arrow-function-visitors-compiled.js","sourcesContent":["/**\n * Copyright 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n/*global exports:true*/\n\n/**\n * Desugars ES6 Arrow functions to ES3 function expressions.\n * If the function contains `this` expression -- automatically\n * binds the function to current value of `this`.\n *\n * Single parameter, simple expression:\n *\n * [1, 2, 3].map(x => x * x);\n *\n * [1, 2, 3].map(function(x) { return x * x; });\n *\n * Several parameters, complex block:\n *\n * this.users.forEach((user, idx) => {\n *   return this.isActive(idx) && this.send(user);\n * });\n *\n * this.users.forEach(function(user, idx) {\n *   return this.isActive(idx) && this.send(user);\n * }.bind(this));\n *\n */\nvar restParamVisitors = require('./es6-rest-param-visitors');\nvar destructuringVisitors = require('./es6-destructuring-visitors');\n\nvar Syntax = require('esprima-fb').Syntax;\nvar utils = require('../src/utils');\n\n/**\n * @public\n */\nfunction visitArrowFunction(traverse, node, path, state) {\n  var notInExpression = (path[0].type === Syntax.ExpressionStatement);\n\n  // Wrap a function into a grouping operator, if it's not\n  // in the expression position.\n  if (notInExpression) {\n    utils.append('(', state);\n  }\n\n  utils.append('function', state);\n  renderParams(traverse, node, path, state);\n\n  // Skip arrow.\n  utils.catchupWhiteSpace(node.body.range[0], state);\n\n  var renderBody = node.body.type == Syntax.BlockStatement\n    ? renderStatementBody\n    : renderExpressionBody;\n\n  path.unshift(node);\n  renderBody(traverse, node, path, state);\n  path.shift();\n\n  // Bind the function only if `this` value is used\n  // inside it or inside any sub-expression.\n  var containsBindingSyntax =\n    utils.containsChildMatching(node.body, function(node) {\n      return node.type === Syntax.ThisExpression\n             || (node.type === Syntax.Identifier\n                 && node.name === \"super\")\n             || (node.type === Syntax.JSXIdentifier\n                 && node.name === 'this');\n    });\n\n  if (containsBindingSyntax) {\n    utils.append('.bind(this)', state);\n  }\n\n  utils.catchupWhiteSpace(node.range[1], state);\n\n  // Close wrapper if not in the expression.\n  if (notInExpression) {\n    utils.append(')', state);\n  }\n\n  return false;\n}\n\nfunction renderParams(traverse, node, path, state) {\n  // To preserve inline typechecking directives, we\n  // distinguish between parens-free and paranthesized single param.\n  if (isParensFreeSingleParam(node, state) || !node.params.length) {\n    utils.append('(', state);\n  }\n  if (node.params.length !== 0) {\n    path.unshift(node);\n    traverse(node.params, path, state);\n    path.unshift();\n  }\n  utils.append(')', state);\n}\n\nfunction isParensFreeSingleParam(node, state) {\n  return node.params.length === 1 &&\n    state.g.source[state.g.position] !== '(';\n}\n\nfunction renderExpressionBody(traverse, node, path, state) {\n  // Wrap simple expression bodies into a block\n  // with explicit return statement.\n  utils.append('{', state);\n\n  // Special handling of rest param.\n  if (node.rest) {\n    utils.append(\n      restParamVisitors.renderRestParamSetup(node, state),\n      state\n    );\n  }\n\n  // Special handling of destructured params.\n  destructuringVisitors.renderDestructuredComponents(\n    node,\n    utils.updateState(state, {\n      localScope: {\n        parentNode: state.parentNode,\n        parentScope: state.parentScope,\n        identifiers: state.identifiers,\n        tempVarIndex: 0\n      }\n    })\n  );\n\n  utils.append('return ', state);\n  renderStatementBody(traverse, node, path, state);\n  utils.append(';}', state);\n}\n\nfunction renderStatementBody(traverse, node, path, state) {\n  traverse(node.body, path, state);\n  utils.catchup(node.body.range[1], state);\n}\n\nvisitArrowFunction.test = function(node, path, state) {\n  return node.type === Syntax.ArrowFunctionExpression;\n};\n\nexports.visitorList = [\n  visitArrowFunction\n];\n\n"]}