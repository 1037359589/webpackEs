{"version":3,"sources":["es6-for-of-visitors.js"],"names":[],"mappings":"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","file":"es6-for-of-visitors-compiled.js","sourcesContent":["/**\n * Copyright 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n/*global exports:true*/\n\n/**\n * Implements ES6 for-of loop, making optimization\n * for arrays. If an object is not an array, instantiates\n * an iterator for this object, assuming the runtime\n * support for the iterator is implemented.\n *\n * ES6:\n *\n * for (var v of <expr>) <body>\n *\n * Compiled ES3:\n *\n * for (var v,\n *      _iter = <expr>,\n *      _isArray = Array.isArray(_iter),\n *      _k = 0,\n *      _iter = _isArray ? _iter : _iter[Symbol.iterator]();;\n * ) {\n *\n *   if (_isArray) {\n *     if (_k >= _iter.length) break;\n *     v = _iter[_k++];\n *   } else {\n *     _k = _iter.next();\n *     if (_k.done) break;\n *     v = _k.value;\n *   }\n *\n *   <body>\n * }\n */\n\nvar Syntax = require('esprima-fb').Syntax;\nvar utils = require('../src/utils');\n\nfunction process(traverse, node, path, state) {\n  utils.move(node.range[0], state);\n  traverse(node, path, state);\n  utils.catchup(node.range[1], state);\n}\n\nfunction visitForOfStatement(traverse, node, path, state) {\n  var iter = utils.injectTempVar(state);\n  var isArray = utils.injectTempVar(state);\n  var k = utils.injectTempVar(state);\n\n  var variable;\n\n  if (node.left.type === Syntax.VariableDeclaration) {\n    variable = node.left.declarations[0].id.name;\n    utils.append('var ' + variable + ';', state);\n  } else {\n    variable = node.left.name;\n  }\n\n  utils.append('for(', state);\n\n  utils.append(iter + '=', state);\n  process(traverse, node.right, path, state);\n\n  // Setup iterator with optimization for arrays.\n  utils.append(\n    ',' + isArray + '=Array.isArray(' + iter + '),' +\n    k + '=0,' +\n    iter + '=' + isArray + '?' + iter + ':' +\n    iter + '[/*global Symbol*/typeof Symbol==\"function\"' +\n      '?Symbol.iterator:\"@@iterator\"]();;',\n    state\n  );\n\n  // Jump to the body creating block if needed.\n  if (node.body.type === Syntax.BlockStatement) {\n    utils.catchup(node.body.range[0] + 1, state);\n  } else {\n    utils.catchup(node.body.range[0], state);\n    utils.append('{', state);\n  }\n\n  // Arrays case.\n  utils.append(\n    'if(' + isArray + '){' +\n    'if(' + k + '>=' + iter + '.length) break;',\n    state\n  );\n\n  utils.append(variable + '=' + iter + '[' + k + '++];', state);\n\n  // Iterators case.\n  utils.append(\n    '}else{' + k + '=' + iter + '.next();' +\n    'if(' + k + '.done) break;',\n    state\n  );\n\n  utils.append(variable + '=' + k + '.value;}', state);\n\n  traverse(node.body, path, state);\n  utils.catchup(node.body.range[1], state);\n\n  if (node.body.type !== Syntax.BlockStatement) {\n    utils.append('}', state);\n  }\n\n  return false;\n}\n\nvisitForOfStatement.test = function(node, path, state) {\n  return node.type === Syntax.ForOfStatement;\n};\n\nexports.visitorList = [\n  visitForOfStatement,\n];\n"]}