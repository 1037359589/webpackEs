{"version":3,"sources":["ReactEventListener.js"],"names":[],"mappings":";;;;;;;;;;;;AAYA,YAAY,CAAC;;AAEb,IAAI,aAAa,GAAG,OAAO,CAAC,wBAAwB,CAAC,CAAC;AACtD,IAAI,oBAAoB,GAAG,OAAO,CAAC,+BAA+B,CAAC,CAAC;AACpE,IAAI,WAAW,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC;AAC3C,IAAI,oBAAoB,GAAG,OAAO,CAAC,wBAAwB,CAAC,CAAC;AAC7D,IAAI,UAAU,GAAG,OAAO,CAAC,cAAc,CAAC,CAAC;AACzC,IAAI,YAAY,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;;AAE7C,IAAI,MAAM,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAC;AACxC,IAAI,cAAc,GAAG,OAAO,CAAC,kBAAkB,CAAC,CAAC;AACjD,IAAI,0BAA0B,GAAG,OAAO,CAAC,qCAAqC,CAAC,CAAC;;AAEhF,IAAI,2BAA2B,GAAG,EAAE;;;;;;;;;AAAC,AASrC,SAAS,UAAU,CAAC,IAAI,EAAE;;;;AAIxB,MAAI,MAAM,GAAG,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AACpC,MAAI,MAAM,GAAG,oBAAoB,CAAC,wBAAwB,CAAC,MAAM,CAAC,CAAC;AACnE,MAAI,SAAS,GAAG,UAAU,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAC;AAC3D,MAAI,MAAM,GAAG,UAAU,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;AACpD,SAAO,MAAM,CAAC;CACf;;;AAAA,AAGD,SAAS,2BAA2B,CAAC,YAAY,EAAE,WAAW,EAAE;AAC9D,MAAI,CAAC,YAAY,GAAG,YAAY,CAAC;AACjC,MAAI,CAAC,WAAW,GAAG,WAAW,CAAC;AAC/B,MAAI,CAAC,SAAS,GAAG,EAAE,CAAC;CACrB;AACD,MAAM,CAAC,2BAA2B,CAAC,SAAS,EAAE;AAC5C,YAAU,EAAE,YAAY;AACtB,QAAI,CAAC,YAAY,GAAG,IAAI,CAAC;AACzB,QAAI,CAAC,WAAW,GAAG,IAAI,CAAC;AACxB,QAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC;GAC3B;CACF,CAAC,CAAC;AACH,WAAW,CAAC,YAAY,CAAC,2BAA2B,EAAE,WAAW,CAAC,iBAAiB,CAAC,CAAC;;AAErF,SAAS,kBAAkB,CAAC,WAAW,EAAE;;;;;;;;;;;AAWvC,OAAK,sBAAsB;AAAC,AAC5B,2BAAyB,CAAC,WAAW,CAAC,CAAC;CACxC;;;AAAA,AAGD,SAAS,yBAAyB,CAAC,WAAW,EAAE;AAC9C,MAAI,cAAc,GAAG,UAAU,CAAC,gBAAgB,CAAC,cAAc,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,IAAI,MAAM;;;;;;AAAC,AAMpG,MAAI,QAAQ,GAAG,cAAc,CAAC;AAC9B,SAAO,QAAQ,EAAE;AACf,eAAW,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;AACrC,YAAQ,GAAG,UAAU,CAAC,QAAQ,CAAC,CAAC;GACjC;;AAED,OAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACrD,kBAAc,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;AAC1C,QAAI,gBAAgB,GAAG,UAAU,CAAC,KAAK,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;AAC9D,sBAAkB,CAAC,eAAe,CAAC,WAAW,CAAC,YAAY,EAAE,cAAc,EAAE,gBAAgB,EAAE,WAAW,CAAC,WAAW,EAAE,cAAc,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC;GAClK;CACF;;;AAAA,AAGD,SAAS,sBAAsB,CAAC,WAAW,EAAE;AAC3C,MAAI,IAAI,GAAG,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC;AACxC,MAAI,mBAAmB,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;AAClC,MAAI,WAAW,GAAG,CAAC,CAAC;AACpB,OAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACpC,QAAI,kBAAkB,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;AACjC,QAAI,kBAAkB,CAAC,QAAQ,KAAK,2BAA2B,EAAE;AAC/D,yBAAmB,GAAG,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;KACnC;;AAAA,AAED,QAAI,WAAW,GAAG,UAAU,CAAC,gBAAgB,CAAC,kBAAkB,CAAC,CAAC;AAClE,QAAI,WAAW,KAAK,kBAAkB,EAAE;AACtC,UAAI,oBAAoB,GAAG,UAAU,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;AAChE,UAAI,SAAS,GAAG,oBAAoB,CAAC,wBAAwB,CAAC,oBAAoB,CAAC,CAAC;AACpF,iBAAW,CAAC,SAAS,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;;AAE/C,UAAI,gBAAgB,GAAG,UAAU,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;AAClE,iBAAW,EAAE,CAAC;AACd,wBAAkB,CAAC,eAAe,CAAC,WAAW,CAAC,YAAY,EAAE,kBAAkB,EAAE,gBAAgB,EAAE,WAAW,CAAC,WAAW,EAAE,mBAAmB,CAAC;;;AAAC,AAGjJ,aAAO,oBAAoB,KAAK,SAAS,EAAE;AACzC,SAAC,EAAE,CAAC;AACJ,0BAAkB,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;AAC7B,4BAAoB,GAAG,UAAU,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;OAC7D;KACF;GACF;AACD,MAAI,WAAW,KAAK,CAAC,EAAE;AACrB,sBAAkB,CAAC,eAAe,CAAC,WAAW,CAAC,YAAY,EAAE,MAAM,EAAE,EAAE,EAAE,WAAW,CAAC,WAAW,EAAE,cAAc,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC;GAC5I;CACF;;AAED,SAAS,kBAAkB,CAAC,EAAE,EAAE;AAC9B,MAAI,cAAc,GAAG,0BAA0B,CAAC,MAAM,CAAC,CAAC;AACxD,IAAE,CAAC,cAAc,CAAC,CAAC;CACpB;;AAED,IAAI,kBAAkB,GAAG;AACvB,UAAQ,EAAE,IAAI;AACd,iBAAe,EAAE,IAAI;;AAErB,eAAa,EAAE,oBAAoB,CAAC,SAAS,GAAG,MAAM,GAAG,IAAI;;AAE7D,mBAAiB,EAAE,UAAU,cAAc,EAAE;AAC3C,sBAAkB,CAAC,eAAe,GAAG,cAAc,CAAC;GACrD;;AAED,YAAU,EAAE,UAAU,OAAO,EAAE;AAC7B,sBAAkB,CAAC,QAAQ,GAAG,CAAC,CAAC,OAAO,CAAC;GACzC;;AAED,WAAS,EAAE,YAAY;AACrB,WAAO,kBAAkB,CAAC,QAAQ,CAAC;GACpC;;;;;;;;;;;;AAYD,kBAAgB,EAAE,UAAU,YAAY,EAAE,eAAe,EAAE,MAAM,EAAE;AACjE,QAAI,OAAO,GAAG,MAAM,CAAC;AACrB,QAAI,CAAC,OAAO,EAAE;AACZ,aAAO,IAAI,CAAC;KACb;AACD,WAAO,aAAa,CAAC,MAAM,CAAC,OAAO,EAAE,eAAe,EAAE,kBAAkB,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC,CAAC;GAClH;;;;;;;;;;;;AAYD,mBAAiB,EAAE,UAAU,YAAY,EAAE,eAAe,EAAE,MAAM,EAAE;AAClE,QAAI,OAAO,GAAG,MAAM,CAAC;AACrB,QAAI,CAAC,OAAO,EAAE;AACZ,aAAO,IAAI,CAAC;KACb;AACD,WAAO,aAAa,CAAC,OAAO,CAAC,OAAO,EAAE,eAAe,EAAE,kBAAkB,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC,CAAC;GACnH;;AAED,oBAAkB,EAAE,UAAU,OAAO,EAAE;AACrC,QAAI,QAAQ,GAAG,kBAAkB,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;AACtD,iBAAa,CAAC,MAAM,CAAC,MAAM,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;GAClD;;AAED,eAAa,EAAE,UAAU,YAAY,EAAE,WAAW,EAAE;AAClD,QAAI,CAAC,kBAAkB,CAAC,QAAQ,EAAE;AAChC,aAAO;KACR;;AAED,QAAI,WAAW,GAAG,2BAA2B,CAAC,SAAS,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;AACnF,QAAI;;;AAGF,kBAAY,CAAC,cAAc,CAAC,kBAAkB,EAAE,WAAW,CAAC,CAAC;KAC9D,SAAS;AACR,iCAA2B,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;KAClD;GACF;CACF,CAAC;;AAEF,MAAM,CAAC,OAAO,GAAG,kBAAkB,CAAC","file":"ReactEventListener-compiled.js","sourcesContent":["/**\n * Copyright 2013-2015, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule ReactEventListener\n * @typechecks static-only\n */\n\n'use strict';\n\nvar EventListener = require('fbjs/lib/EventListener');\nvar ExecutionEnvironment = require('fbjs/lib/ExecutionEnvironment');\nvar PooledClass = require('./PooledClass');\nvar ReactInstanceHandles = require('./ReactInstanceHandles');\nvar ReactMount = require('./ReactMount');\nvar ReactUpdates = require('./ReactUpdates');\n\nvar assign = require('./Object.assign');\nvar getEventTarget = require('./getEventTarget');\nvar getUnboundedScrollPosition = require('fbjs/lib/getUnboundedScrollPosition');\n\nvar DOCUMENT_FRAGMENT_NODE_TYPE = 11;\n\n/**\n * Finds the parent React component of `node`.\n *\n * @param {*} node\n * @return {?DOMEventTarget} Parent container, or `null` if the specified node\n *                           is not nested.\n */\nfunction findParent(node) {\n  // TODO: It may be a good idea to cache this to prevent unnecessary DOM\n  // traversal, but caching is difficult to do correctly without using a\n  // mutation observer to listen for all DOM changes.\n  var nodeID = ReactMount.getID(node);\n  var rootID = ReactInstanceHandles.getReactRootIDFromNodeID(nodeID);\n  var container = ReactMount.findReactContainerForID(rootID);\n  var parent = ReactMount.getFirstReactDOM(container);\n  return parent;\n}\n\n// Used to store ancestor hierarchy in top level callback\nfunction TopLevelCallbackBookKeeping(topLevelType, nativeEvent) {\n  this.topLevelType = topLevelType;\n  this.nativeEvent = nativeEvent;\n  this.ancestors = [];\n}\nassign(TopLevelCallbackBookKeeping.prototype, {\n  destructor: function () {\n    this.topLevelType = null;\n    this.nativeEvent = null;\n    this.ancestors.length = 0;\n  }\n});\nPooledClass.addPoolingTo(TopLevelCallbackBookKeeping, PooledClass.twoArgumentPooler);\n\nfunction handleTopLevelImpl(bookKeeping) {\n  // TODO: Re-enable event.path handling\n  //\n  // if (bookKeeping.nativeEvent.path && bookKeeping.nativeEvent.path.length > 1) {\n  //   // New browsers have a path attribute on native events\n  //   handleTopLevelWithPath(bookKeeping);\n  // } else {\n  //   // Legacy browsers don't have a path attribute on native events\n  //   handleTopLevelWithoutPath(bookKeeping);\n  // }\n\n  void handleTopLevelWithPath; // temporarily unused\n  handleTopLevelWithoutPath(bookKeeping);\n}\n\n// Legacy browsers don't have a path attribute on native events\nfunction handleTopLevelWithoutPath(bookKeeping) {\n  var topLevelTarget = ReactMount.getFirstReactDOM(getEventTarget(bookKeeping.nativeEvent)) || window;\n\n  // Loop through the hierarchy, in case there's any nested components.\n  // It's important that we build the array of ancestors before calling any\n  // event handlers, because event handlers can modify the DOM, leading to\n  // inconsistencies with ReactMount's node cache. See #1105.\n  var ancestor = topLevelTarget;\n  while (ancestor) {\n    bookKeeping.ancestors.push(ancestor);\n    ancestor = findParent(ancestor);\n  }\n\n  for (var i = 0; i < bookKeeping.ancestors.length; i++) {\n    topLevelTarget = bookKeeping.ancestors[i];\n    var topLevelTargetID = ReactMount.getID(topLevelTarget) || '';\n    ReactEventListener._handleTopLevel(bookKeeping.topLevelType, topLevelTarget, topLevelTargetID, bookKeeping.nativeEvent, getEventTarget(bookKeeping.nativeEvent));\n  }\n}\n\n// New browsers have a path attribute on native events\nfunction handleTopLevelWithPath(bookKeeping) {\n  var path = bookKeeping.nativeEvent.path;\n  var currentNativeTarget = path[0];\n  var eventsFired = 0;\n  for (var i = 0; i < path.length; i++) {\n    var currentPathElement = path[i];\n    if (currentPathElement.nodeType === DOCUMENT_FRAGMENT_NODE_TYPE) {\n      currentNativeTarget = path[i + 1];\n    }\n    // TODO: slow\n    var reactParent = ReactMount.getFirstReactDOM(currentPathElement);\n    if (reactParent === currentPathElement) {\n      var currentPathElementID = ReactMount.getID(currentPathElement);\n      var newRootID = ReactInstanceHandles.getReactRootIDFromNodeID(currentPathElementID);\n      bookKeeping.ancestors.push(currentPathElement);\n\n      var topLevelTargetID = ReactMount.getID(currentPathElement) || '';\n      eventsFired++;\n      ReactEventListener._handleTopLevel(bookKeeping.topLevelType, currentPathElement, topLevelTargetID, bookKeeping.nativeEvent, currentNativeTarget);\n\n      // Jump to the root of this React render tree\n      while (currentPathElementID !== newRootID) {\n        i++;\n        currentPathElement = path[i];\n        currentPathElementID = ReactMount.getID(currentPathElement);\n      }\n    }\n  }\n  if (eventsFired === 0) {\n    ReactEventListener._handleTopLevel(bookKeeping.topLevelType, window, '', bookKeeping.nativeEvent, getEventTarget(bookKeeping.nativeEvent));\n  }\n}\n\nfunction scrollValueMonitor(cb) {\n  var scrollPosition = getUnboundedScrollPosition(window);\n  cb(scrollPosition);\n}\n\nvar ReactEventListener = {\n  _enabled: true,\n  _handleTopLevel: null,\n\n  WINDOW_HANDLE: ExecutionEnvironment.canUseDOM ? window : null,\n\n  setHandleTopLevel: function (handleTopLevel) {\n    ReactEventListener._handleTopLevel = handleTopLevel;\n  },\n\n  setEnabled: function (enabled) {\n    ReactEventListener._enabled = !!enabled;\n  },\n\n  isEnabled: function () {\n    return ReactEventListener._enabled;\n  },\n\n  /**\n   * Traps top-level events by using event bubbling.\n   *\n   * @param {string} topLevelType Record from `EventConstants`.\n   * @param {string} handlerBaseName Event name (e.g. \"click\").\n   * @param {object} handle Element on which to attach listener.\n   * @return {?object} An object with a remove function which will forcefully\n   *                  remove the listener.\n   * @internal\n   */\n  trapBubbledEvent: function (topLevelType, handlerBaseName, handle) {\n    var element = handle;\n    if (!element) {\n      return null;\n    }\n    return EventListener.listen(element, handlerBaseName, ReactEventListener.dispatchEvent.bind(null, topLevelType));\n  },\n\n  /**\n   * Traps a top-level event by using event capturing.\n   *\n   * @param {string} topLevelType Record from `EventConstants`.\n   * @param {string} handlerBaseName Event name (e.g. \"click\").\n   * @param {object} handle Element on which to attach listener.\n   * @return {?object} An object with a remove function which will forcefully\n   *                  remove the listener.\n   * @internal\n   */\n  trapCapturedEvent: function (topLevelType, handlerBaseName, handle) {\n    var element = handle;\n    if (!element) {\n      return null;\n    }\n    return EventListener.capture(element, handlerBaseName, ReactEventListener.dispatchEvent.bind(null, topLevelType));\n  },\n\n  monitorScrollValue: function (refresh) {\n    var callback = scrollValueMonitor.bind(null, refresh);\n    EventListener.listen(window, 'scroll', callback);\n  },\n\n  dispatchEvent: function (topLevelType, nativeEvent) {\n    if (!ReactEventListener._enabled) {\n      return;\n    }\n\n    var bookKeeping = TopLevelCallbackBookKeeping.getPooled(topLevelType, nativeEvent);\n    try {\n      // Event queue being processed in the same cycle allows\n      // `preventDefault`.\n      ReactUpdates.batchedUpdates(handleTopLevelImpl, bookKeeping);\n    } finally {\n      TopLevelCallbackBookKeeping.release(bookKeeping);\n    }\n  }\n};\n\nmodule.exports = ReactEventListener;"]}