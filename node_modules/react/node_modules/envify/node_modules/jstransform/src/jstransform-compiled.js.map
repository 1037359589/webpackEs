{"version":3,"sources":["jstransform.js"],"names":[],"mappings":"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","file":"jstransform-compiled.js","sourcesContent":["/**\n * Copyright 2013 Facebook, Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/*jslint node: true*/\n\"use strict\";\n\nvar esprima = require('esprima-fb');\nvar utils = require('./utils');\n\nvar getBoundaryNode = utils.getBoundaryNode;\nvar declareIdentInScope = utils.declareIdentInLocalScope;\nvar initScopeMetadata = utils.initScopeMetadata;\nvar Syntax = esprima.Syntax;\n\n/**\n * @param {object} node\n * @param {object} parentNode\n * @return {boolean}\n */\nfunction _nodeIsClosureScopeBoundary(node, parentNode) {\n  if (node.type === Syntax.Program) {\n    return true;\n  }\n\n  var parentIsFunction =\n    parentNode.type === Syntax.FunctionDeclaration\n    || parentNode.type === Syntax.FunctionExpression\n    || parentNode.type === Syntax.ArrowFunctionExpression;\n\n  var parentIsCurlylessArrowFunc =\n    parentNode.type === Syntax.ArrowFunctionExpression\n    && node === parentNode.body;\n\n  return parentIsFunction\n         && (node.type === Syntax.BlockStatement || parentIsCurlylessArrowFunc);\n}\n\nfunction _nodeIsBlockScopeBoundary(node, parentNode) {\n  if (node.type === Syntax.Program) {\n    return false;\n  }\n\n  return node.type === Syntax.BlockStatement\n         && parentNode.type === Syntax.CatchClause;\n}\n\n/**\n * @param {object} node\n * @param {array} path\n * @param {object} state\n */\nfunction traverse(node, path, state) {\n  /*jshint -W004*/\n  // Create a scope stack entry if this is the first node we've encountered in\n  // its local scope\n  var startIndex = null;\n  var parentNode = path[0];\n  if (!Array.isArray(node) && state.localScope.parentNode !== parentNode) {\n    if (_nodeIsClosureScopeBoundary(node, parentNode)) {\n      var scopeIsStrict = state.scopeIsStrict;\n      if (!scopeIsStrict\n          && (node.type === Syntax.BlockStatement\n              || node.type === Syntax.Program)) {\n          scopeIsStrict =\n            node.body.length > 0\n            && node.body[0].type === Syntax.ExpressionStatement\n            && node.body[0].expression.type === Syntax.Literal\n            && node.body[0].expression.value === 'use strict';\n      }\n\n      if (node.type === Syntax.Program) {\n        startIndex = state.g.buffer.length;\n        state = utils.updateState(state, {\n          scopeIsStrict: scopeIsStrict\n        });\n      } else {\n        startIndex = state.g.buffer.length + 1;\n        state = utils.updateState(state, {\n          localScope: {\n            parentNode: parentNode,\n            parentScope: state.localScope,\n            identifiers: {},\n            tempVarIndex: 0,\n            tempVars: []\n          },\n          scopeIsStrict: scopeIsStrict\n        });\n\n        // All functions have an implicit 'arguments' object in scope\n        declareIdentInScope('arguments', initScopeMetadata(node), state);\n\n        // Include function arg identifiers in the scope boundaries of the\n        // function\n        if (parentNode.params.length > 0) {\n          var param;\n          var metadata = initScopeMetadata(parentNode, path.slice(1), path[0]);\n          for (var i = 0; i < parentNode.params.length; i++) {\n            param = parentNode.params[i];\n            if (param.type === Syntax.Identifier) {\n              declareIdentInScope(param.name, metadata, state);\n            }\n          }\n        }\n\n        // Include rest arg identifiers in the scope boundaries of their\n        // functions\n        if (parentNode.rest) {\n          var metadata = initScopeMetadata(\n            parentNode,\n            path.slice(1),\n            path[0]\n          );\n          declareIdentInScope(parentNode.rest.name, metadata, state);\n        }\n\n        // Named FunctionExpressions scope their name within the body block of\n        // themselves only\n        if (parentNode.type === Syntax.FunctionExpression && parentNode.id) {\n          var metaData =\n            initScopeMetadata(parentNode, path.parentNodeslice, parentNode);\n          declareIdentInScope(parentNode.id.name, metaData, state);\n        }\n      }\n\n      // Traverse and find all local identifiers in this closure first to\n      // account for function/variable declaration hoisting\n      collectClosureIdentsAndTraverse(node, path, state);\n    }\n\n    if (_nodeIsBlockScopeBoundary(node, parentNode)) {\n      startIndex = state.g.buffer.length;\n      state = utils.updateState(state, {\n        localScope: {\n          parentNode: parentNode,\n          parentScope: state.localScope,\n          identifiers: {},\n          tempVarIndex: 0,\n          tempVars: []\n        }\n      });\n\n      if (parentNode.type === Syntax.CatchClause) {\n        var metadata = initScopeMetadata(\n          parentNode,\n          path.slice(1),\n          parentNode\n        );\n        declareIdentInScope(parentNode.param.name, metadata, state);\n      }\n      collectBlockIdentsAndTraverse(node, path, state);\n    }\n  }\n\n  // Only catchup() before and after traversing a child node\n  function traverser(node, path, state) {\n    node.range && utils.catchup(node.range[0], state);\n    traverse(node, path, state);\n    node.range && utils.catchup(node.range[1], state);\n  }\n\n  utils.analyzeAndTraverse(walker, traverser, node, path, state);\n\n  // Inject temp variables into the scope.\n  if (startIndex !== null) {\n    utils.injectTempVarDeclarations(state, startIndex);\n  }\n}\n\nfunction collectClosureIdentsAndTraverse(node, path, state) {\n  utils.analyzeAndTraverse(\n    visitLocalClosureIdentifiers,\n    collectClosureIdentsAndTraverse,\n    node,\n    path,\n    state\n  );\n}\n\nfunction collectBlockIdentsAndTraverse(node, path, state) {\n  utils.analyzeAndTraverse(\n    visitLocalBlockIdentifiers,\n    collectBlockIdentsAndTraverse,\n    node,\n    path,\n    state\n  );\n}\n\nfunction visitLocalClosureIdentifiers(node, path, state) {\n  var metaData;\n  switch (node.type) {\n    case Syntax.ArrowFunctionExpression:\n    case Syntax.FunctionExpression:\n      // Function expressions don't get their names (if there is one) added to\n      // the closure scope they're defined in\n      return false;\n    case Syntax.ClassDeclaration:\n    case Syntax.ClassExpression:\n    case Syntax.FunctionDeclaration:\n      if (node.id) {\n        metaData = initScopeMetadata(getBoundaryNode(path), path.slice(), node);\n        declareIdentInScope(node.id.name, metaData, state);\n      }\n      return false;\n    case Syntax.VariableDeclarator:\n      // Variables have function-local scope\n      if (path[0].kind === 'var') {\n        metaData = initScopeMetadata(getBoundaryNode(path), path.slice(), node);\n        declareIdentInScope(node.id.name, metaData, state);\n      }\n      break;\n  }\n}\n\nfunction visitLocalBlockIdentifiers(node, path, state) {\n  // TODO: Support 'let' here...maybe...one day...or something...\n  if (node.type === Syntax.CatchClause) {\n    return false;\n  }\n}\n\nfunction walker(node, path, state) {\n  var visitors = state.g.visitors;\n  for (var i = 0; i < visitors.length; i++) {\n    if (visitors[i].test(node, path, state)) {\n      return visitors[i](traverse, node, path, state);\n    }\n  }\n}\n\nvar _astCache = {};\n\nfunction getAstForSource(source, options) {\n  if (_astCache[source] && !options.disableAstCache) {\n    return _astCache[source];\n  }\n  var ast = esprima.parse(source, {\n    comment: true,\n    loc: true,\n    range: true,\n    sourceType: options.sourceType\n  });\n  if (!options.disableAstCache) {\n    _astCache[source] = ast;\n  }\n  return ast;\n}\n\n/**\n * Applies all available transformations to the source\n * @param {array} visitors\n * @param {string} source\n * @param {?object} options\n * @return {object}\n */\nfunction transform(visitors, source, options) {\n  options = options || {};\n  var ast;\n  try {\n    ast = getAstForSource(source, options);\n    } catch (e) {\n    e.message = 'Parse Error: ' + e.message;\n    throw e;\n  }\n  var state = utils.createState(source, ast, options);\n  state.g.visitors = visitors;\n\n  if (options.sourceMap) {\n    var SourceMapGenerator = require('source-map').SourceMapGenerator;\n    state.g.sourceMap = new SourceMapGenerator({file: options.filename || 'transformed.js'});\n  }\n\n  traverse(ast, [], state);\n  utils.catchup(source.length, state);\n\n  var ret = {code: state.g.buffer, extra: state.g.extra};\n  if (options.sourceMap) {\n    ret.sourceMap = state.g.sourceMap;\n    ret.sourceMapFilename =  options.filename || 'source.js';\n  }\n  return ret;\n}\n\nexports.transform = transform;\nexports.Syntax = Syntax;\n"]}