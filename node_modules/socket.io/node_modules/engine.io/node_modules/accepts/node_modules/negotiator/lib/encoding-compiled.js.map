{"version":3,"sources":["encoding.js"],"names":[],"mappings":"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","file":"encoding-compiled.js","sourcesContent":["module.exports = preferredEncodings;\npreferredEncodings.preferredEncodings = preferredEncodings;\n\nfunction parseAcceptEncoding(accept) {\n  var acceptableEncodings;\n\n  if (accept) {\n    acceptableEncodings = accept.split(',').map(function(e, i) {\n      return parseEncoding(e.trim(), i);\n    });\n  } else {\n    acceptableEncodings = [];\n  }\n\n  if (!acceptableEncodings.some(function(e) {\n    return e && specify('identity', e);\n  })) {\n    /*\n     * If identity doesn't explicitly appear in the accept-encoding header,\n     * it's added to the list of acceptable encoding with the lowest q\n     *\n     */\n    var lowestQ = 1;\n\n    for(var i = 0; i < acceptableEncodings.length; i++){\n      var e = acceptableEncodings[i];\n      if(e && e.q < lowestQ){\n        lowestQ = e.q;\n      }\n    }\n    acceptableEncodings.push({\n      encoding: 'identity',\n      q: lowestQ / 2,\n    });\n  }\n\n  return acceptableEncodings.filter(function(e) {\n    return e;\n  });\n}\n\nfunction parseEncoding(s, i) {\n  var match = s.match(/^\\s*(\\S+?)\\s*(?:;(.*))?$/);\n\n  if (!match) return null;\n\n  var encoding = match[1];\n  var q = 1;\n  if (match[2]) {\n    var params = match[2].split(';');\n    for (var i = 0; i < params.length; i ++) {\n      var p = params[i].trim().split('=');\n      if (p[0] === 'q') {\n        q = parseFloat(p[1]);\n        break;\n      }\n    }\n  }\n\n  return {\n    encoding: encoding,\n    q: q,\n    i: i\n  };\n}\n\nfunction getEncodingPriority(encoding, accepted) {\n  return (accepted.map(function(a) {\n    return specify(encoding, a);\n  }).filter(Boolean).sort(function (a, b) {\n    if(a.s == b.s) {\n      return a.q > b.q ? -1 : 1;\n    } else {\n      return a.s > b.s ? -1 : 1;\n    }\n  })[0] || {s: 0, q: 0});\n}\n\nfunction specify(encoding, spec) {\n  var s = 0;\n  if(spec.encoding.toLowerCase() === encoding.toLowerCase()){\n    s |= 1;\n  } else if (spec.encoding !== '*' ) {\n    return null\n  }\n\n  return {\n    s: s,\n    q: spec.q,\n  }\n};\n\nfunction preferredEncodings(accept, provided) {\n  accept = parseAcceptEncoding(accept || '');\n  if (provided) {\n    return provided.map(function(type) {\n      return [type, getEncodingPriority(type, accept)];\n    }).filter(function(pair) {\n      return pair[1].q > 0;\n    }).sort(function(a, b) {\n      var pa = a[1];\n      var pb = b[1];\n      return (pb.q - pa.q) || (pb.s - pa.s) || (pa.i - pb.i);\n    }).map(function(pair) {\n      return pair[0];\n    });\n  } else {\n    return accept.sort(function (a, b) {\n      // revsort\n      return (b.q - a.q) || (a.i - b.i);\n    }).filter(function(type){\n      return type.q > 0;\n    }).map(function(type) {\n      return type.encoding;\n    });\n  }\n}\n"]}