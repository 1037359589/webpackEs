{"version":3,"sources":["index_test.js"],"names":[],"mappings":"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","file":"index_test-compiled.js","sourcesContent":["'use strict';\n\nvar sinon = require('sinon');\nvar historyApiFallback = require('../lib');\n\nvar tests = module.exports = {};\n\nvar middleware;\nvar req = null;\nvar requestedUrl;\nvar next;\n\ntests.setUp = function(done) {\n  middleware = historyApiFallback();\n  requestedUrl = '/foo';\n  req = {\n    method: 'GET',\n    url: requestedUrl,\n    headers: {\n      accept: 'text/html, */*'\n    }\n  };\n  next = sinon.stub();\n\n  done();\n};\n\n\n['POST', 'PUT', 'DELETE', 'HEAD', 'OPTIONS'].forEach(function(method) {\n  tests['should ignore ' + method + ' requests'] = function(test) {\n    req.method = method;\n\n    middleware(req, null, next);\n\n    test.equal(req.url, requestedUrl);\n    test.ok(next.called);\n    test.done();\n  };\n});\n\n\ntests['should ignore requests that do not accept html'] = function(test) {\n  req.headers.accept = 'application/json';\n\n  middleware(req, null, next);\n\n  test.equal(req.url, requestedUrl);\n  test.ok(next.called);\n  test.done();\n};\n\n\ntests['should ignore file requests'] = function(test) {\n  var expected = req.url = 'js/app.js';\n\n  middleware(req, null, next);\n\n  test.equal(req.url, expected);\n  test.ok(next.called);\n  test.done();\n};\n\n\ntests['should take JSON preference into account'] = function(test) {\n  req.headers.accept = 'application/json, text/plain, */*';\n\n  middleware(req, null, next);\n\n  test.equal(req.url, requestedUrl);\n  test.ok(next.called);\n  test.done();\n};\n\n\ntests['should rewrite valid requests'] = function(test) {\n  middleware(req, null, next);\n\n  test.equal(req.url, '/index.html');\n  test.ok(next.called);\n  test.done();\n};\n\ntests['should not fail for missing HTTP accept header'] = function(test) {\n  delete req.headers.accept;\n\n  middleware(req, null, next);\n\n  test.equal(req.url, requestedUrl);\n  test.ok(next.called);\n  test.done();\n};\n\ntests['should not fail for missing headers object'] = function(test) {\n  delete req.headers;\n\n  middleware(req, null, next);\n\n  test.equal(req.url, requestedUrl);\n  test.ok(next.called);\n  test.done();\n};\n\ntests['should work in verbose mode'] = function(test) {\n  var expected = req.url = 'js/app.js';\n  middleware = historyApiFallback({\n    verbose: true\n  });\n\n  middleware(req, null, next);\n\n  test.equal(req.url, expected);\n  test.ok(next.called);\n  test.done();\n};\n\ntests['should work with a custom logger'] = function(test) {\n  var expected = req.url = 'js/app.js';\n  var logger = sinon.stub();\n  middleware = historyApiFallback({\n    logger: logger\n  });\n\n  middleware(req, null, next);\n\n  test.equal(req.url, expected);\n  test.ok(next.called);\n  test.ok(logger.calledOnce);\n  test.done();\n};\n\ntests['should rewrite requested path according to rules'] = function(test) {\n  req.url = '/soccer';\n  middleware = historyApiFallback({\n    rewrites: [\n      {from: /\\/soccer/, to: '/soccer.html'}\n    ]\n  });\n\n  middleware(req, null, next);\n\n  test.equal(req.url, '/soccer.html');\n  test.ok(next.called);\n  test.done();\n};\n\ntests['should support functions as rewrite rule'] = function(test) {\n  middleware = historyApiFallback({\n    rewrites: [\n      {\n        from: /^\\/libs\\/(.*)$/,\n        to: function(context) {\n          return './bower_components' + context.parsedUrl.pathname;\n        }\n      }\n    ]\n  });\n\n  req.url = '/libs/jquery/jquery.1.12.0.min.js';\n  middleware(req, null, next);\n  test.equal(req.url, './bower_components/libs/jquery/jquery.1.12.0.min.js');\n  test.ok(next.called);\n\n  next = sinon.stub();\n  var expected = req.url = '/js/main.js';\n  middleware(req, null, next);\n  test.equal(req.url, expected);\n  test.ok(next.called);\n\n  test.done();\n};\n\ntests['should test rewrite rules'] = function(test) {\n  req.url = '/socer';\n  middleware = historyApiFallback({\n    rewrites: [\n      {from: /\\/soccer/, to: '/soccer.html'}\n    ]\n  });\n\n  middleware(req, null, next);\n\n  test.equal(req.url, '/index.html');\n  test.ok(next.called);\n  test.done();\n};\n\ntests['should support custom index file'] = function(test) {\n  var index = 'default.html';\n  req.url = '/socer';\n  middleware = historyApiFallback({\n    index: index\n  });\n\n  middleware(req, null, next);\n\n  test.equal(req.url, index);\n  test.ok(next.called);\n  test.done();\n};\n"]}