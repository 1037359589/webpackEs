{"version":3,"sources":["layer.js"],"names":[],"mappings":"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","file":"layer-compiled.js","sourcesContent":["/*!\n * express\n * Copyright(c) 2009-2013 TJ Holowaychuk\n * Copyright(c) 2013 Roman Shtylman\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar pathRegexp = require('path-to-regexp');\nvar debug = require('debug')('express:router:layer');\n\n/**\n * Module variables.\n * @private\n */\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = Layer;\n\nfunction Layer(path, options, fn) {\n  if (!(this instanceof Layer)) {\n    return new Layer(path, options, fn);\n  }\n\n  debug('new %s', path);\n  var opts = options || {};\n\n  this.handle = fn;\n  this.name = fn.name || '<anonymous>';\n  this.params = undefined;\n  this.path = undefined;\n  this.regexp = pathRegexp(path, this.keys = [], opts);\n\n  if (path === '/' && opts.end === false) {\n    this.regexp.fast_slash = true;\n  }\n}\n\n/**\n * Handle the error for the layer.\n *\n * @param {Error} error\n * @param {Request} req\n * @param {Response} res\n * @param {function} next\n * @api private\n */\n\nLayer.prototype.handle_error = function handle_error(error, req, res, next) {\n  var fn = this.handle;\n\n  if (fn.length !== 4) {\n    // not a standard error handler\n    return next(error);\n  }\n\n  try {\n    fn(error, req, res, next);\n  } catch (err) {\n    next(err);\n  }\n};\n\n/**\n * Handle the request for the layer.\n *\n * @param {Request} req\n * @param {Response} res\n * @param {function} next\n * @api private\n */\n\nLayer.prototype.handle_request = function handle(req, res, next) {\n  var fn = this.handle;\n\n  if (fn.length > 3) {\n    // not a standard request handler\n    return next();\n  }\n\n  try {\n    fn(req, res, next);\n  } catch (err) {\n    next(err);\n  }\n};\n\n/**\n * Check if this route matches `path`, if so\n * populate `.params`.\n *\n * @param {String} path\n * @return {Boolean}\n * @api private\n */\n\nLayer.prototype.match = function match(path) {\n  if (path == null) {\n    // no path, nothing matches\n    this.params = undefined;\n    this.path = undefined;\n    return false;\n  }\n\n  if (this.regexp.fast_slash) {\n    // fast path non-ending match for / (everything matches)\n    this.params = {};\n    this.path = '';\n    return true;\n  }\n\n  var m = this.regexp.exec(path);\n\n  if (!m) {\n    this.params = undefined;\n    this.path = undefined;\n    return false;\n  }\n\n  // store values\n  this.params = {};\n  this.path = m[0];\n\n  var keys = this.keys;\n  var params = this.params;\n\n  for (var i = 1; i < m.length; i++) {\n    var key = keys[i - 1];\n    var prop = key.name;\n    var val = decode_param(m[i]);\n\n    if (val !== undefined || !(hasOwnProperty.call(params, prop))) {\n      params[prop] = val;\n    }\n  }\n\n  return true;\n};\n\n/**\n * Decode param value.\n *\n * @param {string} val\n * @return {string}\n * @private\n */\n\nfunction decode_param(val) {\n  if (typeof val !== 'string' || val.length === 0) {\n    return val;\n  }\n\n  try {\n    return decodeURIComponent(val);\n  } catch (err) {\n    if (err instanceof URIError) {\n      err.message = 'Failed to decode param \\'' + val + '\\'';\n      err.status = err.statusCode = 400;\n    }\n\n    throw err;\n  }\n}\n"]}