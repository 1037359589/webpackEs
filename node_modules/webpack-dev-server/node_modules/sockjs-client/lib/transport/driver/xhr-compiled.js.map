{"version":3,"sources":["xhr.js"],"names":[],"mappings":"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","file":"xhr-compiled.js","sourcesContent":["'use strict';\n\nvar EventEmitter = require('events').EventEmitter\n  , inherits = require('inherits')\n  , http = require('http')\n  , https = require('https')\n  , URL = require('url-parse')\n  ;\n\nvar debug = function() {};\nif (process.env.NODE_ENV !== 'production') {\n  debug = require('debug')('sockjs-client:driver:xhr');\n}\n\nfunction XhrDriver(method, url, payload, opts) {\n  debug(method, url, payload);\n  var self = this;\n  EventEmitter.call(this);\n\n  var parsedUrl = new URL(url);\n  var options = {\n    method: method\n  , hostname: parsedUrl.hostname.replace(/\\[|\\]/g, '')\n  , port: parsedUrl.port\n  , path: parsedUrl.pathname + (parsedUrl.query || '')\n  , headers: opts && opts.headers\n  , agent: false\n  };\n\n  var protocol = parsedUrl.protocol === 'https:' ? https : http;\n  this.req = protocol.request(options, function(res) {\n    res.setEncoding('utf8');\n    var responseText = '';\n\n    res.on('data', function(chunk) {\n      debug('data', chunk);\n      responseText += chunk;\n      self.emit('chunk', 200, responseText);\n    });\n    res.once('end', function() {\n      debug('end');\n      self.emit('finish', res.statusCode, responseText);\n      self.req = null;\n    });\n  });\n\n  this.req.on('error', function(e) {\n    debug('error', e);\n    self.emit('finish', 0, e.message);\n  });\n\n  if (payload) {\n    this.req.write(payload);\n  }\n  this.req.end();\n}\n\ninherits(XhrDriver, EventEmitter);\n\nXhrDriver.prototype.close = function() {\n  debug('close');\n  this.removeAllListeners();\n  if (this.req) {\n    this.req.abort();\n    this.req = null;\n  }\n};\n\nXhrDriver.enabled = true;\nXhrDriver.supportsCORS = true;\n\nmodule.exports = XhrDriver;\n"]}