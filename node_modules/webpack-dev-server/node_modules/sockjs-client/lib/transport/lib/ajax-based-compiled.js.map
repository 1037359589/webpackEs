{"version":3,"sources":["ajax-based.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,IAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC;IAC9B,QAAQ,GAAG,OAAO,CAAC,iBAAiB,CAAC;IACrC,cAAc,GAAG,OAAO,CAAC,mBAAmB,CAAC,CAC9C;;AAEH,IAAI,KAAK,GAAG,YAAW,EAAE,CAAC;AAC1B,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY,EAAE;AACzC,OAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,0BAA0B,CAAC,CAAC;CACtD;;AAED,SAAS,gBAAgB,CAAC,UAAU,EAAE;AACpC,SAAO,UAAS,GAAG,EAAE,OAAO,EAAE,QAAQ,EAAE;AACtC,SAAK,CAAC,oBAAoB,EAAE,GAAG,EAAE,OAAO,CAAC,CAAC;AAC1C,QAAI,GAAG,GAAG,EAAE,CAAC;AACb,QAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;AAC/B,SAAG,CAAC,OAAO,GAAG,EAAC,cAAc,EAAC,YAAY,EAAC,CAAC;KAC7C;AACD,QAAI,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC,GAAG,EAAE,WAAW,CAAC,CAAC;AACjD,QAAI,EAAE,GAAG,IAAI,UAAU,CAAC,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,CAAC,CAAC;AACvD,MAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,UAAS,MAAM,EAAE;AACjC,WAAK,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AACxB,QAAE,GAAG,IAAI,CAAC;;AAEV,UAAI,MAAM,KAAK,GAAG,IAAI,MAAM,KAAK,GAAG,EAAE;AACpC,eAAO,QAAQ,CAAC,IAAI,KAAK,CAAC,cAAc,GAAG,MAAM,CAAC,CAAC,CAAC;OACrD;AACD,cAAQ,EAAE,CAAC;KACZ,CAAC,CAAC;AACH,WAAO,YAAW;AAChB,WAAK,CAAC,OAAO,CAAC,CAAC;AACf,QAAE,CAAC,KAAK,EAAE,CAAC;AACX,QAAE,GAAG,IAAI,CAAC;;AAEV,UAAI,GAAG,GAAG,IAAI,KAAK,CAAC,SAAS,CAAC,CAAC;AAC/B,SAAG,CAAC,IAAI,GAAG,IAAI,CAAC;AAChB,cAAQ,CAAC,GAAG,CAAC,CAAC;KACf,CAAC;GACH,CAAC;CACH;;AAED,SAAS,kBAAkB,CAAC,QAAQ,EAAE,SAAS,EAAE,QAAQ,EAAE,UAAU,EAAE;AACrE,gBAAc,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,SAAS,EAAE,gBAAgB,CAAC,UAAU,CAAC,EAAE,QAAQ,EAAE,UAAU,CAAC,CAAC;CACpG;;AAED,QAAQ,CAAC,kBAAkB,EAAE,cAAc,CAAC,CAAC;;AAE7C,MAAM,CAAC,OAAO,GAAG,kBAAkB,CAAC","file":"ajax-based-compiled.js","sourcesContent":["'use strict';\n\nvar inherits = require('inherits')\n  , urlUtils = require('../../utils/url')\n  , SenderReceiver = require('./sender-receiver')\n  ;\n\nvar debug = function() {};\nif (process.env.NODE_ENV !== 'production') {\n  debug = require('debug')('sockjs-client:ajax-based');\n}\n\nfunction createAjaxSender(AjaxObject) {\n  return function(url, payload, callback) {\n    debug('create ajax sender', url, payload);\n    var opt = {};\n    if (typeof payload === 'string') {\n      opt.headers = {'Content-type':'text/plain'};\n    }\n    var ajaxUrl = urlUtils.addPath(url, '/xhr_send');\n    var xo = new AjaxObject('POST', ajaxUrl, payload, opt);\n    xo.once('finish', function(status) {\n      debug('finish', status);\n      xo = null;\n\n      if (status !== 200 && status !== 204) {\n        return callback(new Error('http status ' + status));\n      }\n      callback();\n    });\n    return function() {\n      debug('abort');\n      xo.close();\n      xo = null;\n\n      var err = new Error('Aborted');\n      err.code = 1000;\n      callback(err);\n    };\n  };\n}\n\nfunction AjaxBasedTransport(transUrl, urlSuffix, Receiver, AjaxObject) {\n  SenderReceiver.call(this, transUrl, urlSuffix, createAjaxSender(AjaxObject), Receiver, AjaxObject);\n}\n\ninherits(AjaxBasedTransport, SenderReceiver);\n\nmodule.exports = AjaxBasedTransport;\n"]}