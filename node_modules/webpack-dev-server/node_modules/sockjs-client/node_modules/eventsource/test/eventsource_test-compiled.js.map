{"version":3,"sources":["eventsource_test.js"],"names":[],"mappings":"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","file":"eventsource_test-compiled.js","sourcesContent":["var EventSource = require('../lib/eventsource')\n  , http = require('http')\n  , https = require('https')\n  , fs = require('fs')\n  , assert = require('assert')\n  , u = require('url');\n\nvar _port = 20000;\nvar servers = 0;\nprocess.on('exit', function () {\n  if (servers != 0) {\n    console.error(\"************ Didn't kill all servers - there is still %d running.\", servers);\n  }\n});\n\nfunction createServer(callback) {\n  var server = http.createServer();\n  configureServer(server, 'http', _port++, callback);\n}\n\nfunction createHttpsServer(callback) {\n  var options = {\n    key: fs.readFileSync(__dirname + '/key.pem'),\n    cert: fs.readFileSync(__dirname + '/certificate.pem')\n  };\n  var server = https.createServer(options);\n  configureServer(server, 'https', _port++, callback);\n}\n\nfunction configureServer(server, protocol, port, callback) {\n  var responses = [];\n\n  var oldClose = server.close;\n  server.close = function() {\n    responses.forEach(function (res) {\n      res.end();\n    });\n    servers--;\n    oldClose.apply(this, arguments);\n  };\n\n  server.on('request', function (req, res) {\n    responses.push(res);\n  });\n\n  server.url = protocol + '://localhost:' + port;\n\n  server.listen(port, function onOpen(err) {\n    servers++;\n    callback(err, server);\n  });\n}\n\nfunction writeEvents(chunks) {\n  return function (req, res) {\n    res.writeHead(200, {'Content-Type': 'text/event-stream'});\n    chunks.forEach(function (chunk) {\n      res.write(chunk);\n    });\n    res.write(':'); // send a dummy comment to ensure that the head is flushed\n  };\n}\n\ndescribe('Parser', function () {\n  it('parses multibyte characters', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"id: 1\\ndata: €豆腐\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = function (m) {\n        assert.equal(\"€豆腐\", m.data);\n        server.close(done);\n      };\n    });\n  });\n\n  it('parses empty lines with multibyte characters', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"\\n\\n\\n\\nid: 1\\ndata: 我現在都看實況不玩遊戲\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = function (m) {\n        assert.equal(\"我現在都看實況不玩遊戲\", m.data);\n        server.close(done);\n      };\n    });\n  });\n\n  it('parses one one-line message in one chunk', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"data: Hello\\n\\n\"]));\n      var es = new EventSource(server.url);\n      es.onmessage = function (m) {\n        assert.equal(\"Hello\", m.data);\n        server.close(done);\n      };\n    });\n  });\n\n  it('parses one one-line message in two chunks', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"data: Hel\", \"lo\\n\\n\"]));\n      var es = new EventSource(server.url);\n      es.onmessage = function (m) {\n        assert.equal(\"Hello\", m.data);\n        server.close(done);\n      };\n    });\n  });\n\n  it('parses two one-line messages in one chunk', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"data: Hello\\n\\n\", \"data: World\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = first;\n\n      function first(m) {\n        assert.equal(\"Hello\", m.data);\n        es.onmessage = second;\n      }\n\n      function second(m) {\n        assert.equal(\"World\", m.data);\n        server.close(done);\n      }\n    });\n  });\n\n  it('parses one two-line message in one chunk', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"data: Hello\\ndata:World\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = function (m) {\n        assert.equal(\"Hello\\nWorld\", m.data);\n        server.close(done);\n      };\n    });\n  });\n\n  it('parses really chopped up unicode data', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      var chopped = \"data: Aslak\\n\\ndata: Hellesøy\\n\\n\".split(\"\");\n      server.on('request', writeEvents(chopped));\n      var es = new EventSource(server.url);\n\n      es.onmessage = first;\n\n      function first(m) {\n        assert.equal(\"Aslak\", m.data);\n        es.onmessage = second;\n      }\n\n      function second(m) {\n        assert.equal(\"Hellesøy\", m.data);\n        server.close(done);\n      }\n    });\n  });\n\n  it('accepts CRLF as separator', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      var chopped = \"data: Aslak\\r\\n\\r\\ndata: Hellesøy\\r\\n\\r\\n\".split(\"\");\n      server.on('request', writeEvents(chopped));\n      var es = new EventSource(server.url);\n\n      es.onmessage = first;\n\n      function first(m) {\n        assert.equal(\"Aslak\", m.data);\n        es.onmessage = second;\n      }\n\n      function second(m) {\n        assert.equal(\"Hellesøy\", m.data);\n        server.close(done);\n      }\n    });\n  });\n\n  it('accepts CR as separator', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      var chopped = \"data: Aslak\\r\\rdata: Hellesøy\\r\\r\".split(\"\");\n      server.on('request', writeEvents(chopped));\n      var es = new EventSource(server.url);\n\n      es.onmessage = first;\n\n      function first(m) {\n        assert.equal(\"Aslak\", m.data);\n        es.onmessage = second;\n      }\n\n      function second(m) {\n        assert.equal(\"Hellesøy\", m.data);\n        server.close(done);\n      }\n    });\n  });\n\n  it('delivers message with explicit event', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"event: greeting\\ndata: Hello\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.addEventListener('greeting', function (m) {\n        assert.equal(\"Hello\", m.data);\n        server.close(done);\n      });\n    });\n  });\n\n  it('ignores comments', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"data: Hello\\n\\n:nothing to see here\\n\\ndata: World\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = first;\n\n      function first(m) {\n        assert.equal(\"Hello\", m.data);\n        es.onmessage = second;\n      }\n\n      function second(m) {\n        assert.equal(\"World\", m.data);\n        server.close(done);\n      }\n    });\n  });\n\n  it('ignores empty comments', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"data: Hello\\n\\n:\\n\\ndata: World\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = first;\n\n      function first(m) {\n        assert.equal(\"Hello\", m.data);\n        es.onmessage = second;\n      }\n\n      function second(m) {\n        assert.equal(\"World\", m.data);\n        server.close(done);\n      }\n    });\n  });\n\n  it('does not ignore multilines strings', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"data: line one\\ndata:\\ndata: line two\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = function (m) {\n        assert.equal('line one\\n\\nline two', m.data);\n        server.close(done);\n      };\n    });\n  });\n\n  it('does not ignore multilines strings even in data beginning', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"data:\\ndata:line one\\ndata: line two\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = function (m) {\n        assert.equal('\\nline one\\nline two', m.data);\n        server.close(done);\n      };\n    });\n  });\n\n  it('causes entire event to be ignored for empty event field', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', writeEvents([\"event:\\n\\ndata: Hello\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      var originalEmit = es.emit;\n      es.emit = function (event) {\n        assert.ok(event === 'message' || event === 'newListener');\n        return originalEmit.apply(this, arguments);\n      };\n      es.onmessage = function (m) {\n        assert.equal('Hello', m.data);\n        server.close(done);\n      };\n    });\n  });\n\n  it('parses relatively huge messages efficiently', function (done) {\n    this.timeout(1000);\n\n    createServer(function (err, server) {\n      if (err) return done(err);\n      var longMessage = \"data: \" + new Array(100000).join('a') + \"\\n\\n\";\n      server.on('request', writeEvents([longMessage]));\n\n      var es = new EventSource(server.url);\n\n      es.onmessage = function () {\n        server.close(done);\n      };\n    });\n  });\n});\n\ndescribe('HTTP Request', function () {\n  it('passes cache-control: no-cache to server', function (done) {\n    createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', function (req) {\n        assert.equal('no-cache', req.headers['cache-control']);\n        server.close(done);\n      });\n      new EventSource(server.url);\n    });\n  });\n\n  it('sets request headers', function (done) {\n    var server = createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', function (req) {\n        assert.equal(req.headers['user-agent'], 'test');\n        assert.equal(req.headers['cookie'], 'test=test');\n        assert.equal(req.headers['last-event-id'], '99');\n        server.close(done);\n      });\n\n      var headers = {\n        'User-Agent': 'test',\n        'Cookie': 'test=test',\n        'Last-Event-ID': '99'\n      };\n      new EventSource(server.url, {headers: headers});\n    });\n  });\n\n  it(\"does not set request headers that don't have a value\", function (done) {\n    var server = createServer(function (err, server) {\n      if (err) return done(err);\n\n      server.on('request', function (req) {\n        assert.equal(req.headers['user-agent'], 'test');\n        assert.equal(req.headers['cookie'], 'test=test');\n        assert.equal(req.headers['last-event-id'], '99');\n        assert.equal(req.headers['X-Something'], undefined);\n        server.close(done);\n      });\n\n      var headers = {\n        'User-Agent': 'test',\n        'Cookie': 'test=test',\n        'Last-Event-ID': '99',\n        'X-Something': null\n      };\n\n      assert.doesNotThrow(\n        function() {\n          new EventSource(server.url, {headers: headers});\n        }\n      );\n    });\n  });\n\n  [301, 307].forEach(function (status) {\n    it('follows http ' + status + ' redirect', function (done) {\n      var redirectSuffix = '/foobar';\n      var clientRequestedRedirectUrl = false;\n      createServer(function (err, server) {\n        if(err) return done(err);\n\n        server.on('request', function (req, res) {\n          if (req.url === '/') {\n            res.writeHead(status, {\n              'Connection': 'Close',\n              'Location': server.url + redirectSuffix\n            });\n            res.end();\n          } else if (req.url === redirectSuffix) {\n            clientRequestedRedirectUrl = true;\n            res.writeHead(200, {'Content-Type': 'text/event-stream'});\n            res.end();\n          }\n        });\n\n        var es = new EventSource(server.url);\n        es.onopen = function () {\n          assert.ok(clientRequestedRedirectUrl);\n          assert.equal(server.url + redirectSuffix, es.url);\n          server.close(done);\n        };\n      });\n    });\n\n\n    it('causes error event when response is ' + status + ' with missing location', function (done) {\n      var redirectSuffix = '/foobar';\n      var clientRequestedRedirectUrl = false;\n      createServer(function (err, server) {\n        if(err) return done(err);\n\n        server.on('request', function (req, res) {\n          res.writeHead(status, {\n            'Connection': 'Close'\n          });\n          res.end();\n        });\n\n        var es = new EventSource(server.url);\n        es.onerror = function (err) {\n          assert.equal(err.status, status);\n          server.close(done);\n        };\n      });\n    });\n  });\n\n  [401, 403].forEach(function (status) {\n    it('causes error event when response status is ' + status, function (done) {\n      createServer(function (err, server) {\n        if(err) return done(err);\n\n        server.on('request', function (req, res) {\n          res.writeHead(status, {'Content-Type': 'text/html'});\n          res.end();\n        });\n\n        var es = new EventSource(server.url);\n        es.onerror = function (err) {\n          assert.equal(err.status, status);\n          server.close(done);\n        };\n      });\n    });\n  });\n});\n\ndescribe('HTTPS Support', function () {\n  it('uses https for https urls', function (done) {\n    createHttpsServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([\"data: hello\\n\\n\"]));\n      var es = new EventSource(server.url, {rejectUnauthorized: false});\n\n      es.onmessage = function (m) {\n        assert.equal(\"hello\", m.data);\n        server.close(done);\n      }\n    });\n  });\n});\n\ndescribe('Reconnection', function () {\n  it('is attempted when server is down', function (done) {\n    var es = new EventSource('http://localhost:' + _port);\n    es.reconnectInterval = 0;\n\n    es.onerror = function () {\n      es.onerror = null;\n      createServer(function (err, server) {\n        if(err) return done(err);\n\n        server.on('request', writeEvents([\"data: hello\\n\\n\"]));\n\n        es.onmessage = function (m) {\n          assert.equal(\"hello\", m.data);\n          server.close(done);\n        }\n      });\n    };\n  });\n\n  it('is attempted when server goes down after connection', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([\"data: hello\\n\\n\"]));\n      var es = new EventSource(server.url);\n      es.reconnectInterval = 0;\n\n      es.onmessage = function (m) {\n        assert.equal(\"hello\", m.data);\n        server.close(function (err) {\n          if(err) return done(err);\n\n          var port = u.parse(es.url).port;\n          configureServer(http.createServer(), 'http', port, function (err, server2) {\n            if(err) return done(err);\n\n            server2.on('request', writeEvents([\"data: world\\n\\n\"]));\n            es.onmessage = function (m) {\n              assert.equal(\"world\", m.data);\n              server2.close(done);\n            };\n          });\n        });\n      };\n    });\n  });\n\n  it('is stopped when server goes down and eventsource is being closed', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([\"data: hello\\n\\n\"]));\n      var es = new EventSource(server.url);\n      es.reconnectInterval = 0;\n\n      es.onmessage = function (m) {\n        assert.equal(\"hello\", m.data);\n        server.close(function (err) {\n          if(err) return done(err);\n          // The server has closed down. es.onerror should now get called,\n          // because es's remote connection was dropped.\n        });\n      };\n\n      es.onerror = function () {\n        // We received an error because the remote connection was closed.\n        // We close es, so we do not want es to reconnect.\n        es.close();\n\n        var port = u.parse(es.url).port;\n        configureServer(http.createServer(), 'http', port, function (err, server2) {\n          if(err) return done(err);\n          server2.on('request', writeEvents([\"data: world\\n\\n\"]));\n\n          es.onmessage = function (m) {\n            return done(new Error(\"Unexpected message: \" + m.data));\n          };\n\n          setTimeout(function () {\n            // We have not received any message within 100ms, we can\n            // presume this works correctly.\n            server2.close(done);\n          }, 100);\n        });\n      };\n    });\n  });\n\n  it('is not attempted when server responds with HTTP 204', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', function (req, res) {\n        res.writeHead(204);\n        res.end();\n      });\n\n      var es = new EventSource(server.url);\n      es.reconnectInterval = 0;\n\n      es.onerror = function (e) {\n        assert.equal(e.status, 204);\n        server.close(function (err) {\n          if(err) return done(err);\n\n          var port = u.parse(es.url).port;\n          configureServer(http.createServer(), 'http', port, function (err, server2) {\n            if(err) return done(err);\n\n            // this will be verified by the readyState\n            // going from CONNECTING to CLOSED,\n            // along with the tests verifying that the\n            // state is CONNECTING when a server closes.\n            // it's next to impossible to write a fail-safe\n            // test for this, though.\n            var ival = setInterval(function () {\n              if (es.readyState == EventSource.CLOSED) {\n                clearInterval(ival);\n                server2.close(done);\n              }\n            }, 5);\n          });\n        });\n      };\n    });\n  });\n\n  it('sends Last-Event-ID http header when it has previously been passed in an event from the server', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents(['id: 10\\ndata: Hello\\n\\n']));\n\n      var es = new EventSource(server.url);\n      es.reconnectInterval = 0;\n\n      es.onmessage = function () {\n        server.close(function (err) {\n          if(err) return done(err);\n\n          var port = u.parse(es.url).port;\n          configureServer(http.createServer(), 'http', port, function (err, server2) {\n            server2.on('request', function (req, res) {\n              assert.equal('10', req.headers['last-event-id']);\n              server2.close(done);\n            });\n          });\n        });\n      };\n    });\n  });\n\n  it('sends correct Last-Event-ID http header when an initial Last-Event-ID header was specified in the constructor', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', function (req, res) {\n        assert.equal('9', req.headers['last-event-id']);\n        server.close(done);\n      });\n\n      new EventSource(server.url, {headers: {'Last-Event-ID': '9'}});\n    });\n  });\n\n  it('does not send Last-Event-ID http header when it has not been previously sent by the server', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents(['data: Hello\\n\\n']));\n\n      var es = new EventSource(server.url);\n      es.reconnectInterval = 0;\n\n      es.onmessage = function () {\n        server.close(function (err) {\n          if(err) return done(err);\n\n          var port = u.parse(es.url).port;\n          configureServer(http.createServer(), 'http', port, function (err, server2) {\n            server2.on('request', function (req, res) {\n              assert.equal(undefined, req.headers['last-event-id']);\n              server2.close(done);\n            });\n          });\n        });\n      };\n    });\n  });\n});\n\ndescribe('readyState', function () {\n  it('has CONNECTING constant', function () {\n    assert.equal(0, EventSource.CONNECTING);\n  });\n\n  it('has OPEN constant', function () {\n    assert.equal(1, EventSource.OPEN);\n  });\n\n  it('has CLOSED constant', function () {\n    assert.equal(2, EventSource.CLOSED);\n  });\n\n  it('is CONNECTING before connection has been established', function (done) {\n    var es = new EventSource('http://localhost:' + _port);\n    assert.equal(EventSource.CONNECTING, es.readyState);\n    es.onerror = function () {\n      es.close();\n      done();\n    }\n  });\n\n  it('is CONNECTING when server has closed the connection', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([]));\n      var es = new EventSource(server.url);\n      es.reconnectInterval = 0;\n\n      es.onopen = function (m) {\n        server.close(function (err) {\n          if(err) return done(err);\n\n          es.onerror = function () {\n            es.onerror = null;\n            assert.equal(EventSource.CONNECTING, es.readyState);\n            done();\n          };\n        });\n      };\n    });\n  });\n\n  it('is OPEN when connection has been established', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([]));\n      var es = new EventSource(server.url);\n\n      es.onopen = function () {\n        assert.equal(EventSource.OPEN, es.readyState);\n        server.close(done);\n      }\n    });\n  });\n\n  it('is CLOSED after connection has been closed', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([]));\n      var es = new EventSource(server.url);\n\n      es.onopen = function () {\n        es.close();\n        assert.equal(EventSource.CLOSED, es.readyState);\n        server.close(done);\n      }\n    });\n  });\n});\n\ndescribe('Properties', function () {\n  it('url exposes original request url', function () {\n    var url = 'http://localhost:' + _port;\n    var es = new EventSource(url);\n    assert.equal(url, es.url);\n  });\n});\n\ndescribe('Events', function () {\n  it('calls onopen when connection is established', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([]));\n      var es = new EventSource(server.url);\n\n      es.onopen = function (event) {\n        assert.equal(event.type, 'open');\n        server.close(done);\n      }\n    });\n  });\n\n  it('supplies the correct origin', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([\"data: hello\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = function (event) {\n        assert.equal(event.origin, server.url);\n        server.close(done);\n      }\n    });\n  });\n\n  it('emits open event when connection is established', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([]));\n      var es = new EventSource(server.url);\n\n      es.addEventListener('open', function (event) {\n        assert.equal(event.type, 'open');\n        server.close(done);\n      });\n    });\n  });\n\n  it('does not emit error when connection is closed by client', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([]));\n      var es = new EventSource(server.url);\n\n      es.addEventListener('open', function () {\n        es.close();\n        process.nextTick(function () {\n          server.close(done);\n        });\n      });\n      es.addEventListener('error', function () {\n        done(new Error('error should not be emitted'));\n      });\n    });\n  });\n\n  it('populates message\\'s lastEventId correctly when the last event has an associated id', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([\"id: 123\\ndata: hello\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = function (m) {\n        assert.equal(m.lastEventId, \"123\");\n        server.close(done);\n      };\n    });\n  });\n\n  it('populates message\\'s lastEventId correctly when the last event doesn\\'t have an associated id', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([\"id: 123\\ndata: Hello\\n\\n\", \"data: World\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = first;\n\n      function first() {\n        es.onmessage = second;\n      }\n\n      function second(m) {\n        assert.equal(m.data, \"World\");\n        assert.equal(m.lastEventId, \"123\");  //expect to get back the previous event id\n        server.close(done);\n      }\n    });\n  });\n\n  it('populates messages with enumerable properties so they can be inspected via console.log().', function (done) {\n    createServer(function (err, server) {\n      if(err) return done(err);\n\n      server.on('request', writeEvents([\"data: World\\n\\n\"]));\n      var es = new EventSource(server.url);\n\n      es.onmessage = function (m) {\n        var enumerableAttributes = Object.keys(m);\n        assert.notEqual(enumerableAttributes.indexOf(\"data\"), -1);\n        assert.notEqual(enumerableAttributes.indexOf(\"type\"), -1);\n        server.close(done);\n      };\n    });\n  });\n});\n"]}