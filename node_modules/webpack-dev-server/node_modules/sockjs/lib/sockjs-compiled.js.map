{"version":3,"sources":["sockjs.js"],"names":[],"mappings":"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","file":"sockjs-compiled.js","sourcesContent":["// Generated by CoffeeScript 1.9.1\n(function() {\n  var App, Listener, Server, chunking_test, events, fs, generate_dispatcher, iframe, sockjsVersion, trans_eventsource, trans_htmlfile, trans_jsonp, trans_websocket, trans_xhr, utils, webjs,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty,\n    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\n  events = require('events');\n\n  fs = require('fs');\n\n  webjs = require('./webjs');\n\n  utils = require('./utils');\n\n  trans_websocket = require('./trans-websocket');\n\n  trans_jsonp = require('./trans-jsonp');\n\n  trans_xhr = require('./trans-xhr');\n\n  iframe = require('./iframe');\n\n  trans_eventsource = require('./trans-eventsource');\n\n  trans_htmlfile = require('./trans-htmlfile');\n\n  chunking_test = require('./chunking-test');\n\n  sockjsVersion = function() {\n    var pkg, x;\n    try {\n      pkg = fs.readFileSync(__dirname + '/../package.json', 'utf-8');\n    } catch (_error) {\n      x = _error;\n    }\n    if (pkg) {\n      return JSON.parse(pkg).version;\n    } else {\n      return null;\n    }\n  };\n\n  App = (function(superClass) {\n    extend(App, superClass);\n\n    function App() {\n      return App.__super__.constructor.apply(this, arguments);\n    }\n\n    App.prototype.welcome_screen = function(req, res) {\n      res.setHeader('content-type', 'text/plain; charset=UTF-8');\n      res.writeHead(200);\n      res.end(\"Welcome to SockJS!\\n\");\n      return true;\n    };\n\n    App.prototype.handle_404 = function(req, res) {\n      res.setHeader('content-type', 'text/plain; charset=UTF-8');\n      res.writeHead(404);\n      res.end('404 Error: Page not found\\n');\n      return true;\n    };\n\n    App.prototype.disabled_transport = function(req, res, data) {\n      return this.handle_404(req, res, data);\n    };\n\n    App.prototype.h_sid = function(req, res, data) {\n      var jsid;\n      req.cookies = utils.parseCookie(req.headers.cookie);\n      if (typeof this.options.jsessionid === 'function') {\n        this.options.jsessionid(req, res);\n      } else if (this.options.jsessionid && res.setHeader) {\n        jsid = req.cookies['JSESSIONID'] || 'dummy';\n        res.setHeader('Set-Cookie', 'JSESSIONID=' + jsid + '; path=/');\n      }\n      return data;\n    };\n\n    App.prototype.log = function(severity, line) {\n      return this.options.log(severity, line);\n    };\n\n    return App;\n\n  })(webjs.GenericApp);\n\n  utils.objectExtend(App.prototype, iframe.app);\n\n  utils.objectExtend(App.prototype, chunking_test.app);\n\n  utils.objectExtend(App.prototype, trans_websocket.app);\n\n  utils.objectExtend(App.prototype, trans_jsonp.app);\n\n  utils.objectExtend(App.prototype, trans_xhr.app);\n\n  utils.objectExtend(App.prototype, trans_eventsource.app);\n\n  utils.objectExtend(App.prototype, trans_htmlfile.app);\n\n  generate_dispatcher = function(options) {\n    var dispatcher, opts_filters, p, t;\n    p = (function(_this) {\n      return function(s) {\n        return new RegExp('^' + options.prefix + s + '[/]?$');\n      };\n    })(this);\n    t = (function(_this) {\n      return function(s) {\n        return [p('/([^/.]+)/([^/.]+)' + s), 'server', 'session'];\n      };\n    })(this);\n    opts_filters = function(options_filter) {\n      if (options_filter == null) {\n        options_filter = 'xhr_options';\n      }\n      return ['h_sid', 'xhr_cors', 'cache_for', options_filter, 'expose'];\n    };\n    dispatcher = [['GET', p(''), ['welcome_screen']], ['GET', p('/iframe[0-9-.a-z_]*.html'), ['iframe', 'cache_for', 'expose']], ['OPTIONS', p('/info'), opts_filters('info_options')], ['GET', p('/info'), ['xhr_cors', 'h_no_cache', 'info', 'expose']], ['OPTIONS', p('/chunking_test'), opts_filters()], ['POST', p('/chunking_test'), ['xhr_cors', 'expect_xhr', 'chunking_test']], ['GET', p('/websocket'), ['raw_websocket']], ['GET', t('/jsonp'), ['h_sid', 'h_no_cache', 'jsonp']], ['POST', t('/jsonp_send'), ['h_sid', 'h_no_cache', 'expect_form', 'jsonp_send']], ['POST', t('/xhr'), ['h_sid', 'h_no_cache', 'xhr_cors', 'xhr_poll']], ['OPTIONS', t('/xhr'), opts_filters()], ['POST', t('/xhr_send'), ['h_sid', 'h_no_cache', 'xhr_cors', 'expect_xhr', 'xhr_send']], ['OPTIONS', t('/xhr_send'), opts_filters()], ['POST', t('/xhr_streaming'), ['h_sid', 'h_no_cache', 'xhr_cors', 'xhr_streaming']], ['OPTIONS', t('/xhr_streaming'), opts_filters()], ['GET', t('/eventsource'), ['h_sid', 'h_no_cache', 'eventsource']], ['GET', t('/htmlfile'), ['h_sid', 'h_no_cache', 'htmlfile']]];\n    if (options.websocket) {\n      dispatcher.push(['GET', t('/websocket'), ['sockjs_websocket']]);\n    } else {\n      dispatcher.push(['GET', t('/websocket'), ['cache_for', 'disabled_transport']]);\n    }\n    return dispatcher;\n  };\n\n  Listener = (function() {\n    function Listener(options1, emit) {\n      this.options = options1;\n      this.handler = bind(this.handler, this);\n      this.app = new App();\n      this.app.options = this.options;\n      this.app.emit = emit;\n      this.app.log('debug', 'SockJS v' + sockjsVersion() + ' ' + 'bound to ' + JSON.stringify(this.options.prefix));\n      this.dispatcher = generate_dispatcher(this.options);\n      this.webjs_handler = webjs.generateHandler(this.app, this.dispatcher);\n      this.path_regexp = new RegExp('^' + this.options.prefix + '([/].+|[/]?)$');\n    }\n\n    Listener.prototype.handler = function(req, res, extra) {\n      if (!req.url.match(this.path_regexp)) {\n        return false;\n      }\n      this.webjs_handler(req, res, extra);\n      return true;\n    };\n\n    Listener.prototype.getHandler = function() {\n      return (function(_this) {\n        return function(a, b, c) {\n          return _this.handler(a, b, c);\n        };\n      })(this);\n    };\n\n    return Listener;\n\n  })();\n\n  Server = (function(superClass) {\n    extend(Server, superClass);\n\n    function Server(user_options) {\n      this.options = {\n        prefix: '',\n        response_limit: 128 * 1024,\n        websocket: true,\n        faye_server_options: null,\n        jsessionid: false,\n        heartbeat_delay: 25000,\n        disconnect_delay: 5000,\n        log: function(severity, line) {\n          return console.log(line);\n        },\n        sockjs_url: 'https://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js'\n      };\n      if (user_options) {\n        utils.objectExtend(this.options, user_options);\n      }\n    }\n\n    Server.prototype.listener = function(handler_options) {\n      var options;\n      options = utils.objectExtend({}, this.options);\n      if (handler_options) {\n        utils.objectExtend(options, handler_options);\n      }\n      return new Listener(options, (function(_this) {\n        return function() {\n          return _this.emit.apply(_this, arguments);\n        };\n      })(this));\n    };\n\n    Server.prototype.installHandlers = function(http_server, handler_options) {\n      var handler;\n      handler = this.listener(handler_options).getHandler();\n      utils.overshadowListeners(http_server, 'request', handler);\n      utils.overshadowListeners(http_server, 'upgrade', handler);\n      return true;\n    };\n\n    Server.prototype.middleware = function(handler_options) {\n      var handler;\n      handler = this.listener(handler_options).getHandler();\n      handler.upgrade = handler;\n      return handler;\n    };\n\n    return Server;\n\n  })(events.EventEmitter);\n\n  exports.createServer = function(options) {\n    return new Server(options);\n  };\n\n  exports.listen = function(http_server, options) {\n    var srv;\n    srv = exports.createServer(options);\n    if (http_server) {\n      srv.installHandlers(http_server);\n    }\n    return srv;\n  };\n\n}).call(this);\n"]}