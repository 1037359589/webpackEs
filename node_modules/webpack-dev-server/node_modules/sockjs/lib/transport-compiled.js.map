{"version":3,"sources":["transport.js"],"names":[],"mappings":"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","file":"transport-compiled.js","sourcesContent":["// Generated by CoffeeScript 1.9.1\n(function() {\n  var GenericReceiver, MAP, ResponseReceiver, Session, SockJSConnection, Transport, closeFrame, register, stream, utils, uuid,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  stream = require('stream');\n\n  uuid = require('node-uuid');\n\n  utils = require('./utils');\n\n  Transport = (function() {\n    function Transport() {}\n\n    return Transport;\n\n  })();\n\n  Transport.CONNECTING = 0;\n\n  Transport.OPEN = 1;\n\n  Transport.CLOSING = 2;\n\n  Transport.CLOSED = 3;\n\n  closeFrame = function(status, reason) {\n    return 'c' + JSON.stringify([status, reason]);\n  };\n\n  SockJSConnection = (function(superClass) {\n    extend(SockJSConnection, superClass);\n\n    function SockJSConnection(_session) {\n      this._session = _session;\n      this.id = uuid.v4();\n      this.headers = {};\n      this.prefix = this._session.prefix;\n    }\n\n    SockJSConnection.prototype.toString = function() {\n      return '<SockJSConnection ' + this.id + '>';\n    };\n\n    SockJSConnection.prototype.write = function(string) {\n      return this._session.send('' + string);\n    };\n\n    SockJSConnection.prototype.end = function(string) {\n      if (string) {\n        this.write(string);\n      }\n      this.close();\n      return null;\n    };\n\n    SockJSConnection.prototype.close = function(code, reason) {\n      return this._session.close(code, reason);\n    };\n\n    SockJSConnection.prototype.destroy = function() {\n      this.end();\n      return this.removeAllListeners();\n    };\n\n    SockJSConnection.prototype.destroySoon = function() {\n      return this.destroy();\n    };\n\n    return SockJSConnection;\n\n  })(stream.Stream);\n\n  SockJSConnection.prototype.__defineGetter__('readable', function() {\n    return this._session.readyState === Transport.OPEN;\n  });\n\n  SockJSConnection.prototype.__defineGetter__('writable', function() {\n    return this._session.readyState === Transport.OPEN;\n  });\n\n  SockJSConnection.prototype.__defineGetter__('readyState', function() {\n    return this._session.readyState;\n  });\n\n  MAP = {};\n\n  Session = (function() {\n    function Session(session_id1, server) {\n      this.session_id = session_id1;\n      this.heartbeat_delay = server.options.heartbeat_delay;\n      this.disconnect_delay = server.options.disconnect_delay;\n      this.prefix = server.options.prefix;\n      this.send_buffer = [];\n      this.is_closing = false;\n      this.readyState = Transport.CONNECTING;\n      if (this.session_id) {\n        MAP[this.session_id] = this;\n      }\n      this.timeout_cb = (function(_this) {\n        return function() {\n          return _this.didTimeout();\n        };\n      })(this);\n      this.to_tref = setTimeout(this.timeout_cb, this.disconnect_delay);\n      this.connection = new SockJSConnection(this);\n      this.emit_open = (function(_this) {\n        return function() {\n          _this.emit_open = null;\n          return server.emit('connection', _this.connection);\n        };\n      })(this);\n    }\n\n    Session.prototype.register = function(req, recv) {\n      if (this.recv) {\n        recv.doSendFrame(closeFrame(2010, \"Another connection still open\"));\n        recv.didClose();\n        return;\n      }\n      if (this.to_tref) {\n        clearTimeout(this.to_tref);\n        this.to_tref = null;\n      }\n      if (this.readyState === Transport.CLOSING) {\n        this.flushToRecv(recv);\n        recv.doSendFrame(this.close_frame);\n        recv.didClose();\n        this.to_tref = setTimeout(this.timeout_cb, this.disconnect_delay);\n        return;\n      }\n      this.recv = recv;\n      this.recv.session = this;\n      this.decorateConnection(req);\n      if (this.readyState === Transport.CONNECTING) {\n        this.recv.doSendFrame('o');\n        this.readyState = Transport.OPEN;\n        process.nextTick(this.emit_open);\n      }\n      if (!this.recv) {\n        return;\n      }\n      this.tryFlush();\n    };\n\n    Session.prototype.decorateConnection = function(req) {\n      var address, headers, i, key, len, ref, remoteAddress, remotePort, socket, x;\n      if (!(socket = this.recv.connection)) {\n        socket = this.recv.response.connection;\n      }\n      try {\n        remoteAddress = socket.remoteAddress;\n        remotePort = socket.remotePort;\n        address = socket.address();\n      } catch (_error) {\n        x = _error;\n      }\n      if (remoteAddress) {\n        this.connection.remoteAddress = remoteAddress;\n        this.connection.remotePort = remotePort;\n        this.connection.address = address;\n      }\n      this.connection.url = req.url;\n      this.connection.pathname = req.pathname;\n      this.connection.protocol = this.recv.protocol;\n      headers = {};\n      ref = ['referer', 'x-client-ip', 'x-forwarded-for', 'x-cluster-client-ip', 'via', 'x-real-ip', 'host', 'user-agent', 'accept-language'];\n      for (i = 0, len = ref.length; i < len; i++) {\n        key = ref[i];\n        if (req.headers[key]) {\n          headers[key] = req.headers[key];\n        }\n      }\n      if (headers) {\n        return this.connection.headers = headers;\n      }\n    };\n\n    Session.prototype.unregister = function() {\n      var delay;\n      delay = this.recv.delay_disconnect;\n      this.recv.session = null;\n      this.recv = null;\n      if (this.to_tref) {\n        clearTimeout(this.to_tref);\n      }\n      if (delay) {\n        return this.to_tref = setTimeout(this.timeout_cb, this.disconnect_delay);\n      } else {\n        return this.timeout_cb();\n      }\n    };\n\n    Session.prototype.flushToRecv = function(recv) {\n      var ref, sb;\n      if (this.send_buffer.length > 0) {\n        ref = [this.send_buffer, []], sb = ref[0], this.send_buffer = ref[1];\n        recv.doSendBulk(sb);\n        return true;\n      }\n      return false;\n    };\n\n    Session.prototype.tryFlush = function() {\n      var x;\n      if (!this.flushToRecv(this.recv) || !this.to_tref) {\n        if (this.to_tref) {\n          clearTimeout(this.to_tref);\n        }\n        x = (function(_this) {\n          return function() {\n            if (_this.recv) {\n              _this.to_tref = setTimeout(x, _this.heartbeat_delay);\n              return _this.recv.doSendFrame(\"h\");\n            }\n          };\n        })(this);\n        this.to_tref = setTimeout(x, this.heartbeat_delay);\n      }\n    };\n\n    Session.prototype.didTimeout = function() {\n      if (this.to_tref) {\n        clearTimeout(this.to_tref);\n        this.to_tref = null;\n      }\n      if (this.readyState !== Transport.CONNECTING && this.readyState !== Transport.OPEN && this.readyState !== Transport.CLOSING) {\n        throw Error('INVALID_STATE_ERR');\n      }\n      if (this.recv) {\n        throw Error('RECV_STILL_THERE');\n      }\n      this.readyState = Transport.CLOSED;\n      this.connection.emit('end');\n      this.connection.emit('close');\n      this.connection = null;\n      if (this.session_id) {\n        delete MAP[this.session_id];\n        return this.session_id = null;\n      }\n    };\n\n    Session.prototype.didMessage = function(payload) {\n      if (this.readyState === Transport.OPEN) {\n        this.connection.emit('data', payload);\n      }\n    };\n\n    Session.prototype.send = function(payload) {\n      if (this.readyState !== Transport.OPEN) {\n        return false;\n      }\n      this.send_buffer.push('' + payload);\n      if (this.recv) {\n        this.tryFlush();\n      }\n      return true;\n    };\n\n    Session.prototype.close = function(status, reason) {\n      if (status == null) {\n        status = 1000;\n      }\n      if (reason == null) {\n        reason = \"Normal closure\";\n      }\n      if (this.readyState !== Transport.OPEN) {\n        return false;\n      }\n      this.readyState = Transport.CLOSING;\n      this.close_frame = closeFrame(status, reason);\n      if (this.recv) {\n        this.recv.doSendFrame(this.close_frame);\n        if (this.recv) {\n          this.recv.didClose();\n        }\n        if (this.recv) {\n          this.unregister();\n        }\n      }\n      return true;\n    };\n\n    return Session;\n\n  })();\n\n  Session.bySessionId = function(session_id) {\n    if (!session_id) {\n      return null;\n    }\n    return MAP[session_id] || null;\n  };\n\n  register = function(req, server, session_id, receiver) {\n    var session;\n    session = Session.bySessionId(session_id);\n    if (!session) {\n      session = new Session(session_id, server);\n    }\n    session.register(req, receiver);\n    return session;\n  };\n\n  exports.register = function(req, server, receiver) {\n    return register(req, server, req.session, receiver);\n  };\n\n  exports.registerNoSession = function(req, server, receiver) {\n    return register(req, server, void 0, receiver);\n  };\n\n  GenericReceiver = (function() {\n    function GenericReceiver(thingy) {\n      this.thingy = thingy;\n      this.setUp(this.thingy);\n    }\n\n    GenericReceiver.prototype.setUp = function() {\n      this.thingy_end_cb = (function(_this) {\n        return function() {\n          return _this.didAbort();\n        };\n      })(this);\n      this.thingy.addListener('close', this.thingy_end_cb);\n      return this.thingy.addListener('end', this.thingy_end_cb);\n    };\n\n    GenericReceiver.prototype.tearDown = function() {\n      this.thingy.removeListener('close', this.thingy_end_cb);\n      this.thingy.removeListener('end', this.thingy_end_cb);\n      return this.thingy_end_cb = null;\n    };\n\n    GenericReceiver.prototype.didAbort = function() {\n      return this.didClose();\n    };\n\n    GenericReceiver.prototype.didClose = function() {\n      if (this.thingy) {\n        this.tearDown(this.thingy);\n        this.thingy = null;\n      }\n      if (this.session) {\n        return this.session.unregister();\n      }\n    };\n\n    GenericReceiver.prototype.doSendBulk = function(messages) {\n      var m, q_msgs;\n      q_msgs = (function() {\n        var i, len, results;\n        results = [];\n        for (i = 0, len = messages.length; i < len; i++) {\n          m = messages[i];\n          results.push(utils.quote(m));\n        }\n        return results;\n      })();\n      return this.doSendFrame('a' + '[' + q_msgs.join(',') + ']');\n    };\n\n    return GenericReceiver;\n\n  })();\n\n  ResponseReceiver = (function(superClass) {\n    extend(ResponseReceiver, superClass);\n\n    ResponseReceiver.prototype.max_response_size = void 0;\n\n    ResponseReceiver.prototype.delay_disconnect = true;\n\n    function ResponseReceiver(request, response, options) {\n      var x;\n      this.request = request;\n      this.response = response;\n      this.options = options;\n      this.curr_response_size = 0;\n      try {\n        this.request.connection.setKeepAlive(true, 5000);\n      } catch (_error) {\n        x = _error;\n      }\n      ResponseReceiver.__super__.constructor.call(this, this.request.connection);\n      if (this.max_response_size === void 0) {\n        this.max_response_size = this.options.response_limit;\n      }\n    }\n\n    ResponseReceiver.prototype.doSendFrame = function(payload) {\n      var r, x;\n      this.curr_response_size += payload.length;\n      r = false;\n      try {\n        this.response.write(payload);\n        r = true;\n      } catch (_error) {\n        x = _error;\n      }\n      if (this.max_response_size && this.curr_response_size >= this.max_response_size) {\n        this.didClose();\n      }\n      return r;\n    };\n\n    ResponseReceiver.prototype.didClose = function() {\n      var x;\n      ResponseReceiver.__super__.didClose.apply(this, arguments);\n      try {\n        this.response.end();\n      } catch (_error) {\n        x = _error;\n      }\n      return this.response = null;\n    };\n\n    return ResponseReceiver;\n\n  })(GenericReceiver);\n\n  exports.GenericReceiver = GenericReceiver;\n\n  exports.Transport = Transport;\n\n  exports.Session = Session;\n\n  exports.ResponseReceiver = ResponseReceiver;\n\n  exports.SockJSConnection = SockJSConnection;\n\n}).call(this);\n"]}