{"version":3,"sources":["sockjs_app.js"],"names":[],"mappings":"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","file":"sockjs_app-compiled.js","sourcesContent":["var sockjs = require('../../index');\n\nexports.install = function(opts, server) {\n    var sjs_echo = sockjs.createServer(opts);\n    sjs_echo.on('connection', function(conn) {\n        console.log('    [+] echo open    ' + conn);\n        conn.on('close', function() {\n            console.log('    [-] echo close   ' + conn);\n        });\n        conn.on('data', function(m) {\n            var d  = JSON.stringify(m);\n            console.log('    [ ] echo message ' + conn,\n                        d.slice(0,64)+\n                        ((d.length > 64) ? '...' : ''));\n            conn.write(m);\n        });\n    });\n\n    var sjs_close = sockjs.createServer(opts);\n    sjs_close.on('connection', function(conn) {\n        console.log('    [+] clos open    ' + conn);\n        conn.close(3000, \"Go away!\");\n        conn.on('close', function() {\n            console.log('    [-] clos close   ' + conn);\n        });\n    });\n\n    var sjs_ticker = sockjs.createServer(opts);\n    sjs_ticker.on('connection', function(conn) {\n        console.log('    [+] ticker open   ' + conn);\n        var tref;\n        var schedule = function() {\n            conn.write('tick!');\n            tref = setTimeout(schedule, 1000);\n        };\n        tref = setTimeout(schedule, 1000);\n        conn.on('close', function() {\n            clearTimeout(tref);\n            console.log('    [-] ticker close   ' + conn);\n        });\n    });\n\n    var broadcast = {};\n    var sjs_broadcast = sockjs.createServer(opts);\n    sjs_broadcast.on('connection', function(conn) {\n        console.log('    [+] broadcast open ' + conn);\n        broadcast[conn.id] = conn;\n        conn.on('close', function() {\n            delete broadcast[conn.id];\n            console.log('    [-] broadcast close' + conn);\n        });\n        conn.on('data', function(m) {\n            console.log('    [-] broadcast message', m);\n            for(var id in broadcast) {\n                broadcast[id].write(m);\n            }\n        });\n    });\n\n    var sjs_amplify = sockjs.createServer(opts);\n    sjs_amplify.on('connection', function(conn) {\n        console.log('    [+] amp open    ' + conn);\n        conn.on('close', function() {\n            console.log('    [-] amp close   ' + conn);\n        });\n        conn.on('data', function(m) {\n            var n = Math.floor(Number(m));\n            n = (n > 0 && n < 19) ? n : 1;\n            console.log('    [ ] amp message: 2^' + n);\n            conn.write(Array(Math.pow(2, n)+1).join('x'));\n        });\n    });\n\n\n    sjs_echo.installHandlers(server, {prefix:'/echo',\n                                      response_limit: 4096}),\n    sjs_echo.installHandlers(server, {prefix:'/disabled_websocket_echo',\n                                      websocket: false});\n    sjs_echo.installHandlers(server, {prefix:'/cookie_needed_echo',\n                                      jsessionid: true});\n    sjs_close.installHandlers(server, {prefix:'/close'});\n    sjs_ticker.installHandlers(server, {prefix:'/ticker'});\n    sjs_amplify.installHandlers(server, {prefix:'/amplify'});\n    sjs_broadcast.installHandlers(server, {prefix:'/broadcast'});\n};\n"]}